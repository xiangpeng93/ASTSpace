<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link rel="shortcut icon" href="img/art.ico" />

    <!-- Bootstrap -->
    <link type="text/css"  href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/fileinput.min.css" rel="stylesheet" type="text/css" />
    <title>活动管理</title>
</head>
<body style="padding-top: 70px" onload="loadPage()" >

<nav class="navbar navbar-default navbar-fixed-top navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">
                AST Space
            </a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li ><a href="index.html">空间介绍 <span class="sr-only">(current)</span></a></li>
                <li><a href="ActiveShow.html">活动展示</a></li>
                <li  class="active"><a href="active_manger.html">活动管理</a></li>
            </ul>
        </div>
    </div>
</nav>

<div name="bodyForAdd">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <h3 class="text-center">
                    活动管理系统
                </h3>
                <div class="row-fluid">
                    <div class="span12">
                        <div class="row">
                            <div class="col-sm-6">
                                <form class="form-search form-inline">
                                    <input class="input-medium search-query" type="text" />
                                    <button type="submit" class="btn btn-group-sm">查找课程</button>
                                </form>
                            </div>
                            <div class="col-sm-6">
                                <button class="btn btn-inverse pull-right" data-toggle="modal" data-target="#addClassModle" style="margin-right: 50px;" type="button" >添加课程</button>
                            </div>
                        </div>
                        <table class="table">
                            <thead>
                            <tr>
                                <th>
                                    课程名称
                                </th>
                                <th>
                                    收费信息
                                </th>
                                <th>
                                    活动时间
                                </th>
                                <th>
                                    课程介绍
                                </th>
                                <th>
                                    活动老师
                                </th>
                                <th>
                                    活动图片
                                </th>
                                <th>
                                    报名链接
                                </th>
                                <th>
                                    报名人数
                                </th>
                            </tr>
                            </thead>
                            <tbody id="active_info_body">
                            <tr>
                                <td>
                                    1
                                </td>
                                <td>
                                    2
                                </td>
                                <td>
3
                                </td>
                                <td>
4
                                </td>
                                <td>
5
                                </td>
                                <td>
6

                                </td>
                                <td>
7
                                </td>
                                <td>
                                    8
                                    </td>
                                <td>
                                    <button class=btn btn-primary id="modifyInfo">修改</button>
                                </td> <td><button class="btn btn-primar" id="deleteInfo">删除</button></td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addClassModle" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    请输入活动信息
                </h4>
            </div>
            <div id="model_info">
                <div class="modal-body" >
                    <form class="bs-example bs-example-form " id="classInfo" role="form">
                        <div class="input-group">
                            <span class="input-group-addon">活动名称：</span>
                            <input name="active_name" type="text" class="form-control" placeholder="请输入课程名称">
                        </div>
                        <br>

                        <div class="input-group">
                            <span class="input-group-addon">收费信息：</span>
                            <input name="active_cost" type="text" class="form-control" placeholder="请输入收费信息">
                        </div>
                        <br>

                        <div class="input-group">
                            <span class="input-group-addon">开课时间：</span>
                            <input name="active_time" type="text" class="form-control" placeholder="请输入开课时间">
                        </div>
                        <br>

                        <div class="input-group">
                            <span class="input-group-addon">课程介绍：</span>
                            <input name="active_msg" type="text" class="form-control text-justify" placeholder="请输入课程简短介绍"/>
                        </div>
                        <br>

                        <div class="input-group">
                            <span class="input-group-addon">授课老师：</span>
                            <input name="active_teacher" type="text" class="form-control text-justify" placeholder="请输入授课老师"/>
                        </div>
                        <br>

                        <label class="control-label">选择课程图片:</label>
                        <input id="fileInputId" name="uploadTest" type="file" multiple class="file-loading">

                        <input type="text" id="picUrlPath" name="active_pic" value="none" style="display: none"/>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal" class="close">关闭
                            </button>
                            <button type="button" id="addActiveBtn" class="btn btn-primary">
                                提交课程
                            </button>
                        </div>
                    </form>

                </div>
            </div>

        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>

<script src="js/fileinput.min.js"></script>

<script src="js/plugins/piexif.min.js" type="text/javascript"></script>
<!-- sortable.min.js is only needed if you wish to sort / rearrange files in initial preview.
     This must be loaded before fileinput.min.js -->
<script src="js/plugins/sortable.min.js" type="text/javascript"></script>
<!-- purify.min.js is only needed if you wish to purify HTML content in your preview for HTML files.
     This must be loaded before fileinput.min.js -->
<script src="js/plugins/purify.min.js" type="text/javascript"></script>

<!-- optionally if you need translation for your language then include
    locale file as mentioned below -->
<script src="js/locales/zh.js"></script>

<script>
    $(document).on('ready', function() {
        $("#fileInputId").fileinput({
            uploadAsync: false, //默认异步上传
            showUpload: true, //是否显示上传按钮,跟随文本框的那个
            showRemove : false, //显示移除按钮,跟随文本框的那个
            showCaption: true,//是否显示标题,就是那个文本框
            showPreview : true, //是否显示预览,不写默认为true
            dropZoneEnabled: false,//是否显示拖拽区域，默认不写为true，但是会占用很大区域
            maxFileCount: 1, //表示允许同时上传的最大文件个数
           // validateInitialCount:true,
            mainClass: "input-group-lg",
            language: 'zh', //设置语言
            allowedPreviewTypes: ['image'],
            allowedFileTypes: ['image'],
            allowedFileExtensions:  ['jpg', 'png','ico','jpeg'],
            uploadUrl: "/uploadPic",
        });
        //异步上传返回结果处理
        $('#fileInputId').on('fileerror', function(event, data, msg) {
            console.log("fileerror");
            console.log(data);
        });
        //异步上传返回结果处理
        $("#fileInputId").on("fileuploaded", function (event, data, previewId, index) {
            console.log("fileuploaded");
            var ref=$(this).attr("data-ref");
           // $("input[name='"+ref+"']").val(data.response.url);

        });

        //同步上传错误处理
        $('#fileInputId').on('filebatchuploaderror', function(event, data, msg) {
            console.log("filebatchuploaderror");
            console.log(data);
        });

        //同步上传返回结果处理
        $("#fileInputId").on("filebatchuploadsuccess", function (event, data, previewId, index) {
            console.log("filebatchuploadsuccess");
            console.log(data);
            console.log((data.response.url));
            $("#picUrlPath").val(data.response.url);
            console.log($("#picUrlPath").val());
        });

        //上传前
        $('#fileInputId').on('filepreupload', function(event, data, previewId, index) {
            console.log("filepreupload");
        });
    });

    $("#addActiveBtn").click(function(){
        {
            var param = $("#classInfo").serialize();
            var submitUrl = "http://astspace.org/active_add?"+param;
            console.log(submitUrl);
            htmlobj=$.ajax({url:submitUrl,async:false});
            $("#model_info").html(htmlobj.responseText);
        }
    });
    function  test() {
        window.location.reload();
    }
    
    function  loadPage() {
        var submitUrl = "http://astspace.org/active_query";
        console.log(submitUrl);
        htmlobj=$.ajax({url:submitUrl,async:false});
        $("#active_info_body").html(htmlobj.responseText);
    }

    $("table td button").click(function()
    {
        var row = $(this).parent().index() + 1; // 行位置
        var col = $(this).index() + 1; // 列位置
        alert("当前位置：第"+row+"行，第"+col+"列");
        var id=$.trim($(this).parent().parent().children("td").get(0).innerHTML);
        var name=$.trim($(this).parent().parent().children("td").get(1).innerHTML);
        var age=$.trim($(this).parent().parent().children("td").get(2).innerHTML);
        alert("id="+id+" name="+name+" age="+age);
        alert( this.id);
    });

</script>
</body>
</html>